# 驱动参数

## shell

### 启动参数

- `shebang`: `string`，执行程序，默认 `/bin/bash`
- `args`: `[string]`，程序启动参数，默认 `["-c"]`
- `envs`: `[string, string]`，程序执行环境变量，默认为空

```yaml
ctx:
  sh:
    type: shell
    args:
      envs:
        SH_CTX_ENV_KEY: sh-ctx-env-val
  py:
    type: shell
    args:
      shebang: python3
      args:
        - -c
      envs:
        PY_CTX_ENV_KEY: py-ctx-env-val
```

### 执行命令

**请求**

- `command`: `string`，执行命令，必填
- `envs`: `[string, string]`，程序执行环境变量，默认为空
- `decoder`: `string`，解码规则，将结果按某种规则解析成对象，方便后面的结果校验和引用，可选值 `text/json/yaml`，默认 `text`

注意: `case.step.req.envs` 和 `ctx.args.envs` 是合并关系，`ctx.dft.req.envs` 是覆盖关系

**返回**

- `exitCode`: 状态返回码
- `stdout`: 标准输出
- `stderr`: 标准错误
- `json`: 如果设置了 decoder，并且格式正确，会将结果转换成对象
- `err`: 如果设置了 decoder，捕获解析失败的异常

```yaml
case:
  - name: TestShell
    step:
      - ctx: sh
        req:
          command: |
            echo SH_CTX_ENV_KEY=${SH_CTX_ENV_KEY}
            echo CASE_ENV_KYE=${CASE_ENV_KYE}
          envs:
            CASE_ENV_KYE: case-env-val
        res:
          exitCode: 0
          stdout: |
            SH_CTX_ENV_KEY=sh-ctx-env-val
            CASE_ENV_KYE=case-env-val
      - ctx: py
        req:
          command: |
            import json
            print(json.dumps({"key1": "val1", "key2": "val2"}))
          decoder: json
        res:
          exitCode: 0
          stdout: |
              {"key1": "val1", "key2": "val2"}
          stderr: ""
          json:
            key1: val1
            key2: val2
```

